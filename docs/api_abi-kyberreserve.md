---
id: API_ABI-KyberReserve
title: KyberReserve
---
[//]: # (tagline)
# contract KyberReserve
is [KyberReserveInterface](api_abi-kyberreserveinterface.md), [Withdrawable](api_abi-withdrawable.md), Utils\
imports ERC20Interface, Utils, [Withdrawable](api_abi-withdrawable.md),  [ConversionRatesInterface](api_abi-conversionratesinterface.md), [SanityRatesInterface](api_abi-sanityratesinterface.md), [KyberReserveInterface](api_abi-kyberreserveinterface.md)

*Source*: [KyberReserve.sol](https://github.com/KyberNetwork/smart-contracts/blob/master/contracts/KyberReserve.sol)

The KyberReserve contract's role is to execute exchanges and provide rates for Kyber Network. The contract has no direct interaction with the end users (the only interaction with them is via the network platform). Its main interaction is with the reserve operator who manages the token inventory and feeds exchange rates every few minutes.
___

## INDEX

<AUTOGENERATED_TABLE_OF_CONTENTS>

## REFERENCE

### Events

### `DepositToken`
Event for logging of ERC20 token deposits.
___
event __DepositToken__(ERC20 token, uint amount)
| Parameter | Type  | Description                  |
| --------- |:-----:|:----------------------------:|
| `token`  | ERC20  | ERC20 token contract address |
| `amount` | uint   | ERC20 token amount in wei    |

<br />

### `NewTokenWallet`
Event for logging new token wallet address
___
event __NewTokenWallet__(ERC20 token, address wallet)
| Parameter | Type  | Description                                                 |
| --------- |:-----:|:-----------------------------------------------------------:|
| `token`  | ERC20  | ERC20 token contract address |
| `wallet`  | address  | token wallet address |

<br />

### `SetContractAddresses`
Event for logging the setting of contract addresses.
___
event __SetContractAddresses__(address network, address rate, address sanity)
| Parameter | Type    | Description                      |
| --------- |:-------:|:--------------------------------:|
| `network` | address | KyberNetwork contract address    |
| `rate`    | address | ConversionRates contract address |
| `sanity`  | address | SanityRates contract address     |

<br />

### `TradeEnabled`
Event for logging if trade is enabled for the reserve.
___
event __TradeEnabled__(bool enable)
| Parameter | Type  | Description                                                 |
| --------- |:-----:|:-----------------------------------------------------------:|
| `enable`  | bool  | `true` if reserve is enabled, otherwise `false` if disabled |

<br />

### `TradeExecute`
Event for logging of executed trades.
___
event __TradeExecute__(address indexed origin, address src, uint srcAmount, address destToken, uint destAmount, address destAddress)
| Parameter     | Type    | Description                                    |
| --------------|:-------:|:----------------------------------------------:|
| `origin`      | address | sender's address                               |
| `src`         | address | source ERC20 token contract address            |
| `srcAmount`   | uint    | wei amount of source ERC20 tokens              |
| `destToken`   | address | destination ERC20 token contract address       |
| `destAmount`  | uint    | wei amount of destination ERC20 tokens         |
| `destAddress` | address | recipient address for destination ERC20 tokens |

<br />

### `WithdrawAddressApproved`
Event for logging of enabling or disabling of withdrawal address for token.
___
event __WithdrawAddressApproved__(ERC20 token, address addr, bool approve)
| Parameter | Type    | Description                                                            |
| ----------|:-------:|:----------------------------------------------------------------------:|
| `token`   | ERC20   | ERC20 token contract address                                           |
| `addr`    | address | withdrawal address                                                     |
| `approve` | bool    | `true` if address is enabled, otherwise `false` if address is disabled |

<br />

### `WithdrawFunds`
Event for logging of withdrawn funds when withdraw function is invoked.
___
event __WithdrawFunds__(ERC20 token, uint amount, address destination)
| Parameter     | Type    | Description                             |
| --------------|:-------:|:---------------------------------------:|
| `token`       | ERC20   | ERC20 token contract address            |
| `amount`      | uint    | wei amount of tokens that was withdrawn |
| `destination` | address | recipient address of withdrawn funds    |
<br />

### Functions

### `KyberReserve`
Contract constructor. Note that constructor methods are called exactly once during contract instantiation and cannot be called again.
___
function __KyberReserve__(address \_kyberNetwork, ConversionRatesInterface \_ratesContract, address \_admin) public
| Parameter        | Type                     | Description                      |
| -----------------|:------------------------:|:--------------------------------:|
| `_kyberNetwork`  | address                  | KyberNetwork contract address    |
| `_ratesContract` | ConversionRatesInterface | ConversionRates contract address |
| `_admin`         | address                  | admin's wallet address           |
___
Web3 Example:
```js
// DISCLAIMER: Code snippets in this guide are just examples and you
// should always do your own testing. If you have questions, visit our
// https://t.me/KyberDeveloper.

const fs = require('fs');
const solc = require('solc');
const Web3 = require('web3');

const web3 = new Web3(new Web3.providers.HttpProvider('http://localhost:8545'));
const input = fs.readFileSync('KyberReserve.sol', 'utf8');
const output = await solc.compile(input, 1);
const bytecode = output.contracts['KyberReserve'].bytecode;
const abi = JSON.parse(output.contracts['KyberReserve'].interface);

const KyberReserve = new web3.eth.Contract(JSON.parse(abi));
const _kyberNetwork = '0x964F35fAe36d75B1e72770e244F6595B68508CF5';
const _ratesContract = '0x798AbDA6Cc246D0EDbA912092A2a3dBd3d11191B';
const _admin = '<ADMIN ADDRESS>';

const deploy = KyberReserve.deploy({
  data: `0x${bytecode}`,
  arguments: [
    _kyberNetwork,
    _ratesContract,
    _admin
  ]
});

broadcastTx(deploy)
```
Code snippet reference: [broadcastTx()](api_abi-web3.md#broadcasting-transactions)

<br />

### `approveWithdrawAddress`
Adds or deletes a reserve's withdrawal address to or from the network. Only admin can invoke.
___
function __approveWithdrawAddress__(ERC20 token, address addr, bool approve) public onlyAdmin
| Parameter | Type    | Description                                                            |
| ----------|:-------:|:----------------------------------------------------------------------:|
| `token`   | ERC20   | ERC20 token contract address                                           |
| `addr`    | address | withdrawal address                                                     |
| `approve` | bool    | `true` if address is enabled, otherwise `false` if address is disabled |
Modifiers: [onlyAdmin](api_abi-permissiongroups.md#onlyadmin)
___
Web3 Example:
```js
// DISCLAIMER: Code snippets in this guide are just examples and you
// should always do your own testing. If you have questions, visit our
// https://t.me/KyberDeveloper.

const token = '0xdd974D5C2e2928deA5F71b9825b8b646686BD200' // KNC
const addr = WITHDRAWAL_ADDRESS
const approve = true

transactionData = KyberReserve.methods.approveWithdrawAddress(
  token,
  addr,
  approve
).encodeABI()

txReceipt = await web3.eth.sendTransaction({
    from: ADMIN_ADDRESS,
    to: KYBER_RESERVE_ADDRESS,
    data: transactionData
})
```
<br />

### `disableTrade`
Disable trading for the reserve. Only alerter can invoke.
___
function __disableTrade__() public onlyAlerter returns (bool)\
Modifiers: [onlyAlerter](api_abi-permissiongroups.md#onlyalerter)\
**Returns:**\
`true` if trade is successfully disabled, otherwise `false`
___
Web3 Example:
```js
// DISCLAIMER: Code snippets in this guide are just examples and you
// should always do your own testing. If you have questions, visit our
// https://t.me/KyberDeveloper.

transactionData = KyberReserve.methods.disableTrade().encodeABI()

txReceipt = await web3.eth.sendTransaction({
    from: ALERTER_ADDRESS,
    to: KYBER_RESERVE_ADDRESS,
    data: transactionData
})
```

<br />

### `enableTrade`
Enables trading in the reserve. Only admin can invoke.
___
function __enableTrade__() public onlyAdmin returns (bool)\
Modifiers: [onlyAdmin](api_abi-permissiongroups.md#onlyadmin)\
**Returns:**\
`true` if trading is successfully enabled, otherwise `false`
___
Web3 Example:
```js
// DISCLAIMER: Code snippets in this guide are just examples and you
// should always do your own testing. If you have questions, visit our
// https://t.me/KyberDeveloper.

transactionData = KyberReserve.methods.enableTrade().encodeABI()

txReceipt = await web3.eth.sendTransaction({
    from: ADMIN_ADDRESS,
    to: KYBER_RESERVE_ADDRESS,
    data: transactionData
})
```
<br />

### `getBalance`
Get the token balance of the reserve.
___
function __getBalance__(ERC20 token) public view returns (uint)
| Parameter | Type    | Description                  |
| --------- |:-------:|:----------------------------:|
| `token`   | ERC20   | ERC20 token contract address |
**Returns:**\
ERC20 token balance of the reserve in wei
___
Web3 Example:
```js
// DISCLAIMER: Code snippets in this guide are just examples and you
// should always do your own testing. If you have questions, visit our
// https://t.me/KyberDeveloper.

const token = '0xdd974D5C2e2928deA5F71b9825b8b646686BD200'; // KNC
tokenBalance = await KyberReserve.methods.getBalance(token).call()
```
<br />

### `getConversionRate`
Gets the conversion rate for a pair of tokens at block number.
___
function __getConversionRate__(ERC20 src, ERC20 dest, uint srcQty, uint blockNumber) public view returns (uint)
| Parameter     | Type   | Description                              |
| ------------- |:------:|:----------------------------------------:|
| `src`         | ERC20  | source ERC20 token contract address      |
| `dest`        | ERC20  | destination ERC20 token contract address |
| `srcQty`      | uint   | wei amount of source ERC20 token         |
| `blockNumber` | uint   | current block height or block number     |
**Returns:**\
Current conversion rate of token pairs at block number
___
Web3 Example:
```js
// DISCLAIMER: Code snippets in this guide are just examples and you
// should always do your own testing. If you have questions, visit our
// https://t.me/KyberDeveloper.

const src = '0xeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee'  // ETH
const dest = '0xdd974D5C2e2928deA5F71b9825b8b646686BD200' // KNC
const srcQty = new web3.utils.BN('3000000000000000000000')
const blockNumber = 6015205

conversionRate = await KyberReserve.methods.getConversionRate(
  src,
  dest,
  srcQty,
  blockNumber
).call()
```
<br />

### `getDestQty`
Get the calculated ERC20 token quantity in the destination wallet address.
___
function __getDestQty__(ERC20 src, ERC20 dest, uint srcQty, uint rate) public view returns (uint)
| Parameter | Type  | Description                              |
| --------- |:-----:|:----------------------------------------:|
| `src`     | ERC20 | source ERC20 token contract address      |
| `dest`    | ERC20 | destination ERC20 token contract address |
| `srcQty`  | uint  | wei amount of source ERC20 token         |
| `rate`    | uint  | the conversion rate between src and dest |
**Returns:**\
Calculated destination ERC20 token quantity in wei
___
Web3 Example:
```js
// DISCLAIMER: Code snippets in this guide are just examples and you
// should always do your own testing. If you have questions, visit our
// https://t.me/KyberDeveloper.

const src = '0xeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee'  // ETH
const dest = '0xdd974D5C2e2928deA5F71b9825b8b646686BD200' // KNC
const srcQty = new web3.utils.BN('3000000000000000000000')
const rate = new web3.utils.BN('55555')

let destQty = await KyberReserve.methods.getDestQty(
  src,
  dest,
  srcQty,
  rate
).call()
```
<br />

### `getSrcQty`
Get the calculated ERC20 token quantity in the source wallet address.
___
function __getSrcQty__(ERC20 src, ERC20 dest, uint dstQty, uint rate) public view returns (uint)
| Parameter | Type  | Description                              |
| --------- |:-----:|:----------------------------------------:|
| `src`     | ERC20 | source ERC20 token contract address      |
| `dest`    | ERC20 | destination ERC20 token contract address |
| `dstQty`  | uint  | wei amount of source ERC20 token         |
| `rate`    | uint  | the conversion rate between src and dest |
**Returns:**\
Calculated source ERC20 token quantity in wei
___
Web3 Example:
```js
// DISCLAIMER: Code snippets in this guide are just examples and you
// should always do your own testing. If you have questions, visit our
// https://t.me/KyberDeveloper.

const src = '0xeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee'  // ETH
const dest = '0xdd974D5C2e2928deA5F71b9825b8b646686BD200' // KNC
const destQty = new web3.utils.BN('3000000000000000000000')
const rate = new web3.utils.BN('55555')

let srcQty = KyberReserve.methods.getSrcQty(
  src,
  dest,
  destQty,
  rate
).call()
```
<br />

### `setContracts`
Sets the contract addresses. Only admin can invoke.
___
function __setContracts__(address \_kyberNetwork, ConversionRatesInterface \_conversionRates, SanityRatesInterface \_sanity) public onlyAdmin
| Parameter          | Type                     | Description                                    |
| -------------------|:------------------------:|:----------------------------------------------:|
| `_kyberNetwork`    | address                  | KyberNetwork contract address                  |
| `_conversionRates` | ConversionRatesInterface | ConversionRates contract address               |
| `_sanity`     | SanityRatesInterface     | SanityRates contract address                   |
Modifiers: [onlyAdmin](api_abi-permissiongroups.md#onlyadmin)
___
Web3 Example:
```js
// DISCLAIMER: Code snippets in this guide are just examples and you
// should always do your own testing. If you have questions, visit our
// https://t.me/KyberDeveloper.

const _kyberNetwork = '0x964F35fAe36d75B1e72770e244F6595B68508CF5';
const _conversionRates = '0x798AbDA6Cc246D0EDbA912092A2a3dBd3d11191B';
const _sanity = '0xdfc85C08d5e5924aB49750E006CF8a826ffb7B13';

transactionData = KyberReserve.methods.setContracts(
  _kyberNetwork,
  _conversionRates,
  _sanity
).encodeABI()

txReceipt = await web3.eth.sendTransaction({
    from: ADMIN_ADDRESS,
    to: KYBER_RESERVE_ADDRESS,
    data: transactionData
})
```
<br />

### `setTokenWallet`
Set the token wallet address to deposit / withdraw the specified token from / to. Only admin can invoke.
___
function __setTokenWallet__(ERC20 token, address wallet) public onlyAdmin
| Parameter          | Type                     | Description                                    |
| -------------------|:------------------------:|:----------------------------------------------:|
| `token`    | ERC20                  | ERC20 token contract address                  |
| `wallet` | address | wallet address               |
Modifiers: [onlyAdmin](api_abi-permissiongroups.md#onlyadmin)
___
Web3 Example:
```js
// DISCLAIMER: Code snippets in this guide are just examples and you
// should always do your own testing. If you have questions, visit our
// https://t.me/KyberDeveloper.

token = '0xdd974D5C2e2928deA5F71b9825b8b646686BD200' // KNC
wallet = WALLET_ADDRESS

transactionData = KyberReserve.methods.setTokenWallet(token,wallet).encodeABI()

txReceipt = await web3.eth.sendTransaction({
    from: ADMIN_ADDRESS,
    to: KYBER_RESERVE_ADDRESS,
    data: transactionData
})
```
<br />

### `withdraw`
Withdraw an ERC20 token from the reserve to the destination address. Only operator can invoke.
___
function __withdraw__(ERC20 token, uint amount, address destination) public onlyOperator returns (bool)
| Parameter     | Type    | Description                                    |
| ------------- |:-------:|:----------------------------------------------:|
| `token`       | ERC20   | ERC20 token contract address                   |
| `amount`      | uint    | ERC20 token amount in wei                      |
| `destination` | address | recipient address for destination ERC20 tokens |
Modifiers: [onlyOperator](api_abi-permissiongroups.md#onlyoperator)\
**Returns:**\
`true` if the withdrawal was successful, otherwise `false` if unsuccessful
___
Web3 Example:
```js
// DISCLAIMER: Code snippets in this guide are just examples and you
// should always do your own testing. If you have questions, visit our
// https://t.me/KyberDeveloper.

const token = '0xdd974D5C2e2928deA5F71b9825b8b646686BD200'; // KNC
const amount = new web3.utils.BN('12345');
const destination = '0x12370dc7321e84ca96fcaedd0c8abcebbaeb68c6';

transactionData = KyberReserve.methods.withdraw(
  token,
  amount,
  destination,
).encodeABI()

txReceipt = await web3.eth.sendTransaction({
    from: OPERATOR_ADDRESS,
    to: KYBER_RESERVE_ADDRESS,
    data: transactionData
})
```
<br />
